<!--list.wxml-->
<view class="container">
  <!-- å„¿ç«¥ä¿¡æ¯æ  -->
  <view class="child-bar" bindtap="switchChild">
    <view class="child-info">
      <text class="child-name">{{currentChild?.name || 'æœªé€‰æ‹©'}}</text>
      <text class="child-balance">ä½™é¢: Â¥{{currentChild?.balance?.toFixed(2) || '0.00'}}</text>
    </view>
    <view class="switch-arrow">â€º</view>
  </view>

  <!-- è¿‡æ»¤å™¨åŒºåŸŸ -->
  <view class="filter-bar">
    <view class="filter-group">
      <view class="filter-item {{filter.type === 'all' ? 'active' : ''}}" bindtap="changeTypeFilter" data-type="all">å…¨éƒ¨</view>
      <view class="filter-item {{filter.type === 'income' ? 'active' : ''}}" bindtap="changeTypeFilter" data-type="income">æ”¶å…¥</view>
      <view class="filter-item {{filter.type === 'expense' ? 'active' : ''}}" bindtap="changeTypeFilter" data-type="expense">æ”¯å‡º</view>
    </view>
    <view class="filter-group">
      <view class="filter-item {{filter.dateRange === 'all' ? 'active' : ''}}" bindtap="changeDateFilter" data-range="all">å…¨éƒ¨</view>
      <view class="filter-item {{filter.dateRange === 'today' ? 'active' : ''}}" bindtap="changeDateFilter" data-range="today">ä»Šå¤©</view>
      <view class="filter-item {{filter.dateRange === 'week' ? 'active' : ''}}" bindtap="changeDateFilter" data-range="week">æœ¬å‘¨</view>
      <view class="filter-item {{filter.dateRange === 'month' ? 'active' : ''}}" bindtap="changeDateFilter" data-range="month">æœ¬æœˆ</view>
    </view>
    <view class="filter-action">
      <text class="reset-btn" bindtap="resetFilter">é‡ç½®</text>
    </view>
  </view>

  <!-- äº¤æ˜“è®°å½•åˆ—è¡¨ -->
  <view class="transaction-list">
    <block wx:if="{{loading}}">
      <view class="loading">
        <text>åŠ è½½ä¸­...</text>
      </view>
    </block>
    <block wx:else>
      <block wx:if="{{transactions.length > 0}}">
        <view class="transaction-item" wx:for="{{transactions}}" wx:key="id">
          <view class="transaction-content" bindtap="viewTransactionDetail" data-id="{{item.id}}">
            <view class="transaction-icon {{item.type}}">
              <text>{{item.type === 'income' ? '+' : '-'}}</text>
            </view>
            <view class="transaction-info">
              <view class="transaction-desc">{{item.description}}</view>
              <view class="transaction-meta">
                <text class="transaction-category">{{item.categoryName}}</text>
                <text class="transaction-date">{{item.date}}</text>
              </view>
            </view>
            <view class="transaction-amount {{item.type === 'income' ? 'income-amount' : 'expense-amount'}}">
              {{item.type === 'income' ? '+' : '-'}}Â¥{{item.amount}}
            </view>
          </view>
          <view class="transaction-actions">
            <text class="action-btn edit" bindtap="editTransaction" data-id="{{item.id}}">ç¼–è¾‘</text>
            <text class="action-btn delete" bindtap="deleteTransaction" data-id="{{item.id}}">åˆ é™¤</text>
          </view>
        </view>
      </block>
      <block wx:else>
        <view class="empty-state">
          <view class="empty-state-icon">ğŸ“‹</view>
          <view class="empty-state-text">æš‚æ— äº¤æ˜“è®°å½•</view>
          <view class="empty-state-desc">ç‚¹å‡»å³ä¸‹è§’æŒ‰é’®æ·»åŠ ç¬¬ä¸€æ¡è®°å½•</view>
        </view>
      </block>
    </block>
  </view>

  <!-- æ·»åŠ æŒ‰é’® -->
  <view class="add-btn" bindtap="addTransaction">
    <text>+</text>
  </view>
</view>