<!--add.wxml-->
<view class="container">
  <view class="header">
    <text class="page-title">{{editingId ? 'ç¼–è¾‘è®°å½•' : 'æ·»åŠ è®°å½•'}}</text>
    <text class="child-info">{{currentChild?.name || 'æœªé€‰æ‹©'}}</text>
  </view>

  <!-- äº¤æ˜“ç±»å‹é€‰æ‹© -->
  <view class="section">
    <view class="section-title">äº¤æ˜“ç±»å‹</view>
    <view class="type-select">
      <view 
        class="type-item {{transaction.type === 'expense' ? 'active' : ''}}" 
        bindtap="switchTransactionType" 
        data-type="expense"
      >
        <text class="type-icon">-</text>
        <text class="type-text">æ”¯å‡º</text>
      </view>
      <view 
        class="type-item {{transaction.type === 'income' ? 'active' : ''}}" 
        bindtap="switchTransactionType" 
        data-type="income"
      >
        <text class="type-icon">+</text>
        <text class="type-text">æ”¶å…¥</text>
      </view>
    </view>
  </view>

  <!-- é‡‘é¢è¾“å…¥ -->
  <view class="section">
    <view class="section-title">é‡‘é¢</view>
    <view class="amount-input">
      <text class="currency-symbol">Â¥</text>
      <input 
        type="digit" 
        placeholder="0.00" 
        value="{{transaction.amount}}" 
        bindinput="inputAmount"
        class="amount" 
      />
    </view>
  </view>

  <!-- åˆ†ç±»é€‰æ‹© -->
  <view class="section">
    <view class="section-title">åˆ†ç±»</view>
    <view class="category-grid">
      <view 
        class="category-item {{transaction.category === item.id ? 'active' : ''}}" 
        wx:for="{{categories[transaction.type]}}" 
        wx:key="id" 
        bindtap="selectCategory"
        data-category="{{item.id}}"
      >
        <view class="category-icon">
          <text>{{item.id === 'pocket_money' ? 'ğŸ’°' : 
                  item.id === 'reward' ? 'ğŸ†' : 
                  item.id === 'gift' ? 'ğŸ' : 
                  item.id === 'food' ? 'ğŸ”' : 
                  item.id === 'entertainment' ? 'ğŸ®' : 
                  item.id === 'shopping' ? 'ğŸ›ï¸' : 
                  item.id === 'study' ? 'ğŸ“š' : 
                  'ğŸ“¦'}}
          </text>
        </view>
        <text class="category-name">{{item.name}}</text>
      </view>
    </view>
  </view>

  <!-- æè¿°è¾“å…¥ -->
  <view class="section">
    <view class="section-title">æè¿°</view>
    <input 
      type="text" 
      placeholder="è¯·è¾“å…¥è¯¦ç»†æè¿°" 
      value="{{transaction.description}}" 
      bindinput="inputDescription"
      class="description-input" 
    />
  </view>

  <!-- æ—¥æœŸæ—¶é—´é€‰æ‹© -->
  <view class="section">
    <view class="section-title">æ—¥æœŸæ—¶é—´</view>
    <input 
      type="datetime-local" 
      value="{{transaction.date}}" 
      bindinput="selectDateTime"
      class="datetime-input" 
    />
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-buttons">
    <button class="btn-cancel" type="default" bindtap="cancel">å–æ¶ˆ</button>
    <button class="btn-save" type="primary" bindtap="saveTransaction" loading="{{loading}}" disabled="{{loading}}">
      {{loading ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜'}}
    </button>
  </view>
</view>